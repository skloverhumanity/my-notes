<!DOCTYPE html>
<html lang="mr">
<head>
    <meta charset="UTF-8">
    <title>AI MindMap - Final Success</title>
    <style>
        body { font-family: sans-serif; background: #f4f7f6; margin: 0; padding: 20px; text-align: center; }
        .container { max-width: 500px; margin: auto; background: white; padding: 25px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        input, textarea { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; }
        button { width: 100%; padding: 15px; background: #1a73e8; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 16px; }
        #status { margin-top: 15px; font-weight: bold; color: #1a73e8; }
        #resImg { margin-top: 25px; max-width: 100%; display: none; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
    </style>
</head>
<body>

<div class="container">
    <h2>üöÄ AI Backtesting Map</h2>
    <p style="font-size: 13px; color: #666;">GRU ‡§Ü‡§£‡§ø LSTM ‡§Æ‡•â‡§°‡•á‡§≤ ‡§¨‡•Ö‡§ï‡§ü‡•á‡§Ç‡§∏‡•ç‡§ü‡§ø‡§Ç‡§ó‡§∏‡§æ‡§†‡•Ä ‡§µ‡§æ‡§™‡§∞‡§æ</p>
    
    <input type="password" id="apiKey" placeholder="‡§§‡•Å‡§Æ‡§ö‡•Ä ‡§®‡§µ‡•Ä‡§® Enabled API Key ‡§ü‡§æ‡§ï‡§æ">
    <textarea id="topic" rows="3">Fast Backtesting with GRU and LSTM Models</textarea>
    
    <button onclick="generate()">AI ‡§Æ‡•Ö‡§™ ‡§§‡§Ø‡§æ‡§∞ ‡§ï‡§∞‡§æ ‚ú®</button>
    <div id="status">Ready</div>
</div>

<img id="resImg" src="">

<script>
async function generate() {
    const key = document.getElementById('apiKey').value.trim();
    const topic = document.getElementById('topic').value.trim();
    const status = document.getElementById('status');
    const img = document.getElementById('resImg');

    if(!key) { alert("‡§ï‡•É‡§™‡§Ø‡§æ API Key ‡§ü‡§æ‡§ï‡§æ!"); return; }

    status.innerText = "‡§Æ‡§æ‡§π‡§ø‡§§‡•Ä ‡§§‡§Ø‡§æ‡§∞ ‡§π‡•ã‡§§ ‡§Ü‡§π‡•á... ‡§ï‡•É‡§™‡§Ø‡§æ ‡•ß‡•¶ ‡§∏‡•á‡§ï‡§Ç‡§¶ ‡§•‡§æ‡§Ç‡§¨‡§æ.";
    img.style.display = "none";

    // ‡§¨‡§¶‡§≤: ‡§Ü‡§™‡§£ 'v1' ‡§ê‡§µ‡§ú‡•Ä 'v1beta' ‡§µ‡§æ‡§™‡§∞‡•Ç‡§® ‡§Æ‡•â‡§°‡•á‡§≤‡§ö‡•á ‡§®‡§æ‡§µ 'gemini-1.5-flash-latest' ‡§ï‡•á‡§≤‡•á ‡§Ü‡§π‡•á
    const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent?key=${key}`;

    const prompt = `Generate a Mermaid mindmap for ${topic}. 
    Focus on: 
    1. GRU (Gated Recurrent Unit) speed benefits.
    2. LSTM (Long Short-Term Memory) efficiency for backtesting.
    3. Faster execution compared to standard RNN.
    Use ONLY mermaid syntax starting with "mindmap". No extra text.`;

    try {
        const res = await fetch(url, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
        });

        const data = await res.json();

        if (data.candidates && data.candidates[0].content) {
            let code = data.candidates[0].content.parts[0].text;
            let cleanCode = code.replace(/```mermaid|```/g, "").trim();
            
            // Mermaid ‡§ï‡•ã‡§°‡§≤‡§æ ‡§á‡§Æ‡•á‡§ú‡§Æ‡§ß‡•ç‡§Ø‡•á ‡§¨‡§¶‡§≤‡§£‡•á (Kroki API)
            const encoded = btoa(unescape(encodeURIComponent(cleanCode)));
            img.src = `https://kroki.io/mermaid/svg/${encoded}`;
            img.style.display = "block";
            status.style.color = "green";
            status.innerText = "‡§Æ‡•Ö‡§™ ‡§Ø‡§∂‡§∏‡•ç‡§µ‡•Ä‡§∞‡•Ä‡§§‡•ç‡§Ø‡§æ ‡§§‡§Ø‡§æ‡§∞ ‡§ù‡§æ‡§≤‡§æ! ‚úÖ";
        } else {
            // ‡§ú‡§∞ ‡§ó‡•Å‡§ó‡§≤‡§®‡•á ‡§™‡•Å‡§®‡•ç‡§π‡§æ ‡§è‡§∞‡§∞ ‡§¶‡§ø‡§≤‡§æ ‡§§‡§∞ ‡§§‡•ã ‡§µ‡§æ‡§ö‡§æ‡§Ø‡§≤‡§æ ‡§∏‡•ã‡§™‡§æ ‡§ï‡§∞‡•Ç‡§® ‡§¶‡§æ‡§ñ‡§µ‡§£‡•á
            status.style.color = "red";
            status.innerHTML = "<b>API ‡§Æ‡•á‡§∏‡•á‡§ú:</b> " + (data.error ? data.error.message : "Key ‡§Ö‡§Æ‡§æ‡§®‡•ç‡§Ø");
            console.log(data);
        }
    } catch (e) {
        status.innerText = "‡§á‡§Ç‡§ü‡§∞‡§®‡•á‡§ü ‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§§‡§™‡§æ‡§∏‡§æ!";
    }
}
</script>

</body>
</html>
