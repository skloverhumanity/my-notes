<!DOCTYPE html>
<html lang="mr">
<head>
    <meta charset="UTF-8">
    <title>AI Backtesting Mindmap</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; text-align: center; background-color: #f0f4f8; padding: 20px; }
        .container { background: white; padding: 30px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); display: inline-block; max-width: 500px; width: 100%; }
        input { width: 90%; padding: 12px; margin: 10px 0; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 16px; }
        button { width: 95%; padding: 12px; background-color: #1a73e8; color: white; border: none; border-radius: 8px; font-size: 16px; cursor: pointer; font-weight: bold; }
        button:hover { background-color: #1557b0; }
        #status { margin-top: 20px; font-weight: bold; color: #555; }
        #mapResult { margin-top: 20px; max-width: 100%; border-radius: 10px; display: none; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
    </style>
</head>
<body>

<div class="container">
    <h2>üìà Backtesting AI Map</h2>
    <p>‡§§‡•Å‡§Æ‡§ö‡•ç‡§Ø‡§æ Key ‡§¶‡•ç‡§µ‡§æ‡§∞‡•á GRU & LSTM ‡§Æ‡•Ö‡§™ ‡§§‡§Ø‡§æ‡§∞ ‡§ï‡§∞‡§æ</p>
    <input type="password" id="apiKey" placeholder="‡§§‡•Å‡§Æ‡§ö‡•Ä API Key ‡§á‡§•‡•á ‡§ü‡§æ‡§ï‡§æ">
    <button onclick="runProject()">‡§Æ‡•Ö‡§™ ‡§§‡§Ø‡§æ‡§∞ ‡§ï‡§∞‡§æ ‚ú®</button>
    <div id="status">Ready</div>
</div>

<br>
<img id="mapResult" src="">

<script>
async function runProject() {
    const key = document.getElementById('apiKey').value.trim();
    const status = document.getElementById('status');
    const img = document.getElementById('mapResult');

    if(!key) { alert("‡§ï‡•É‡§™‡§Ø‡§æ ‡§Ü‡§ß‡•Ä Key ‡§ü‡§æ‡§ï‡§æ!"); return; }

    status.innerText = "‡§§‡§™‡§æ‡§∏‡§§ ‡§Ü‡§π‡•á... ‡§Ü‡§£‡§ø ‡§Æ‡•Ö‡§™ ‡§¨‡§®‡§µ‡§§ ‡§Ü‡§π‡•á...";
    img.style.display = "none";

    // ‡§Ü‡§™‡§£ ‡§Ü‡§§‡§æ ‡§∏‡§∞‡•ç‡§µ‡§æ‡§§ ‡§ú‡§æ‡§∏‡•ç‡§§ ‡§ö‡§æ‡§≤‡§£‡§æ‡§∞‡•á ‡§Æ‡•â‡§°‡•á‡§≤ ‡§µ‡§æ‡§™‡§∞‡§§ ‡§Ü‡§π‡•ã‡§§
    const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${key}`;

    const prompt = "Create a mermaid mindmap for Backtesting with GRU and LSTM models. Highlight why GRU is faster than LSTM. Start with 'mindmap' syntax. No extra text.";

    try {
        const response = await fetch(url, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
        });

        const data = await response.json();

        if (data.candidates) {
            let aiText = data.candidates[0].content.parts[0].text;
            let cleanCode = aiText.replace(/```mermaid|```/g, "").trim();
            
            // Kroki API ‡§¶‡•ç‡§µ‡§æ‡§∞‡•á ‡§á‡§Æ‡•á‡§ú‡§Æ‡§ß‡•ç‡§Ø‡•á ‡§∞‡•Ç‡§™‡§æ‡§Ç‡§§‡§∞
            const encoded = btoa(unescape(encodeURIComponent(cleanCode)));
            img.src = `https://kroki.io/mermaid/svg/${encoded}`;
            img.style.display = "block";
            status.style.color = "green";
            status.innerText = "‡§Ø‡§∂‡§∏‡•ç‡§µ‡•Ä! ‡§§‡•Å‡§Æ‡§ö‡§æ GRU/LSTM ‡§Æ‡•Ö‡§™ ‡§§‡§Ø‡§æ‡§∞ ‡§Ü‡§π‡•á. ‚úÖ";
        } else {
            status.style.color = "red";
            status.innerText = "Error: " + (data.error ? data.error.message : "Key ‡§®‡•Ä‡§ü ‡§§‡§™‡§æ‡§∏‡§æ ‡§ï‡§ø‡§Ç‡§µ‡§æ API 'Enable' ‡§ï‡§∞‡§æ.");
        }
    } catch (e) {
        status.innerText = "‡§®‡•á‡§ü‡§µ‡§∞‡•ç‡§ï ‡§ï‡§ø‡§Ç‡§µ‡§æ ‡§ï‡•ã‡§°‡§Æ‡§ß‡•ç‡§Ø‡•á ‡§è‡§∞‡§∞ ‡§Ü‡§π‡•á.";
    }
}
</script>

</body>
</html>
