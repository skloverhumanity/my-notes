<!DOCTYPE html>
<html lang="mr">
<head>
    <meta charset="UTF-8">
    <title>AI Trading Map</title>
    <style>
        body { font-family: sans-serif; text-align: center; padding: 20px; background: #f4f7f6; }
        .box { background: white; padding: 20px; border-radius: 10px; display: inline-block; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        input { padding: 10px; width: 250px; margin: 10px; border: 1px solid #ccc; border-radius: 5px; }
        button { padding: 10px 20px; background: #1a73e8; color: white; border: none; cursor: pointer; border-radius: 5px; font-weight: bold; }
        #status { margin-top: 15px; color: blue; font-weight: bold; }
        img { margin-top: 20px; max-width: 90%; display: none; border: 2px solid #ddd; }
    </style>
</head>
<body>

<div class="box">
    <h3>üìà GRU & LSTM Backtesting Map</h3>
    <input type="password" id="apiKey" placeholder="‡§§‡•Å‡§Æ‡§ö‡•Ä API Key ‡§ü‡§æ‡§ï‡§æ">
    <br>
    <button id="btn" onclick="makeMap()">‡§Æ‡•Ö‡§™ ‡§§‡§Ø‡§æ‡§∞ ‡§ï‡§∞‡§æ ‚ú®</button>
    <div id="status">Ready</div>
</div>
<br>
<img id="mapImg" src="">

<script>
async function makeMap() {
    const key = document.getElementById('apiKey').value.trim();
    const status = document.getElementById('status');
    const img = document.getElementById('mapImg');
    const btn = document.getElementById('btn');

    if(!key) { alert("Key ‡§ü‡§æ‡§ï‡§æ!"); return; }

    // ‡§¨‡§ü‡§£ ‡§°‡§ø‡§∏‡•á‡§¨‡§≤ ‡§ï‡§∞‡§æ ‡§ú‡•á‡§£‡•á‡§ï‡§∞‡•Ç‡§® ‡§°‡§¨‡§≤ ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§π‡•ã‡§£‡§æ‡§∞ ‡§®‡§æ‡§π‡•Ä
    btn.disabled = true;
    status.innerText = "‡§ï‡§æ‡§Æ ‡§∏‡•Å‡§∞‡•Ç ‡§Ü‡§π‡•á... ‡§ï‡•É‡§™‡§Ø‡§æ ‡§•‡§æ‡§Ç‡§¨‡§æ.";
    img.style.display = "none";

    // ‡§Ü‡§™‡§£ gemini-1.5-flash ‡§µ‡§æ‡§™‡§∞‡§§ ‡§Ü‡§π‡•ã‡§§ ‡§ú‡•á ‡§ú‡§æ‡§∏‡•ç‡§§ ‡§∏‡•ç‡§ü‡•á‡§¨‡§≤ ‡§Ü‡§π‡•á
    const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${key}`;

    const prompt = "Create a mermaid mindmap for Backtesting Trading with GRU and LSTM. Show why GRU is faster. Give only mermaid code.";

    try {
        const res = await fetch(url, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
        });

        const data = await res.json();

        if (data.candidates) {
            let code = data.candidates[0].content.parts[0].text.replace(/```mermaid|```/g, "").trim();
            const encoded = btoa(unescape(encodeURIComponent(code)));
            img.src = `https://kroki.io/mermaid/svg/${encoded}`;
            img.style.display = "block";
            status.style.color = "green";
            status.innerText = "‡§Ø‡§∂‡§∏‡•ç‡§µ‡•Ä! ‚úÖ";
        } else {
            status.style.color = "red";
            status.innerText = "Error: " + (data.error ? data.error.message : "Key ‡§®‡•Ä‡§ü ‡§§‡§™‡§æ‡§∏‡§æ");
        }
    } catch (e) {
        status.innerText = "‡§®‡•á‡§ü‡§µ‡§∞‡•ç‡§ï ‡§™‡•ç‡§∞‡•â‡§¨‡•ç‡§≤‡•á‡§Æ!";
    } finally {
        btn.disabled = false; // ‡§¨‡§ü‡§£ ‡§™‡•Å‡§®‡•ç‡§π‡§æ ‡§∏‡•Å‡§∞‡•Ç ‡§ï‡§∞‡§æ
    }
}
</script>

</body>
</html>
