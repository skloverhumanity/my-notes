<!DOCTYPE html>
<html lang="mr">
<head>
    <meta charset="UTF-8">
    <title>AI MindMap - Instant Fix</title>
    <style>
        body { font-family: sans-serif; margin: 0; background: #f4f7f6; display: flex; flex-direction: column; height: 100vh; }
        .sidebar { width: 300px; background: white; padding: 20px; border-right: 1px solid #ddd; }
        .viewer { flex: 1; padding: 20px; display: flex; justify-content: center; align-items: center; background: #e5e5e5; overflow: auto; }
        #mapImage { max-width: 100%; box-shadow: 0 10px 30px rgba(0,0,0,0.2); border-radius: 10px; display: none; background: white; }
        textarea, input { width: 100%; padding: 10px; margin-bottom: 15px; border: 1px solid #ccc; border-radius: 5px; box-sizing: border-box; }
        button { width: 100%; padding: 12px; background: #1a73e8; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; }
        #status { font-size: 13px; color: #666; margin-top: 10px; }
    </style>
</head>
<body>

<div style="display: flex; flex: 1;">
    <div class="sidebar">
        <h2>ЁЯза AI рдореЕрдк</h2>
        <label>Gemini API Key:</label>
        <input type="password" id="apiKey" placeholder="Key рдкреЗрд╕реНрдЯ рдХрд░рд╛">
        <label>рддреБрдордЪрд╛ рд╡рд┐рд╖рдп:</label>
        <textarea id="topic" rows="4" placeholder="рдЙрджрд╛. Trading Strategy"></textarea>
        <button onclick="generateMap()">AI рдореЕрдк рддрдпрд╛рд░ рдХрд░рд╛</button>
        <div id="status">Ready</div>
        <p style="font-size: 11px; color: #888; margin-top: 20px;">рдЯреАрдк: рд╣рд╛ рдореЕрдк рдереЗрдЯ рдЗрдореЗрдЬ рд╕реНрд╡рд░реВрдкрд╛рдд рддрдпрд╛рд░ рд╣реЛрдИрд▓.</p>
    </div>

    <div class="viewer">
        <div id="loading" style="display: none;">рд▓реЛрдб рд╣реЛрдд рдЖрд╣реЗ... рдХреГрдкрдпрд╛ рдерд╛рдВрдмрд╛.</div>
        <img id="mapImage" src="" alt="Mindmap">
    </div>
</div>

<script>
    async function generateMap() {
        const key = document.getElementById('apiKey').value.trim();
        const topic = document.getElementById('topic').value.trim();
        const status = document.getElementById('status');
        const img = document.getElementById('mapImage');
        const loading = document.getElementById('loading');

        if (!key || !topic) { alert("Key рдЖрдгрд┐ рд╡рд┐рд╖рдп рдЖрд╡рд╢реНрдпрдХ!"); return; }

        status.innerText = "AI рдХрдбреВрди рдЖрд░рд╛рдЦрдбрд╛ рдШреЗрдд рдЖрд╣реЗ...";
        loading.style.display = "block";
        img.style.display = "none";

        // AI рд▓рд╛ рд╕реЛрдкреНрдпрд╛ рднрд╛рд╖реЗрдд рд╕рд╛рдВрдЧрдгреЗ
        const prompt = `Create a text-based mindmap for "${topic}". 
        Use this format:
        Root
        -- Branch 1
        --- Sub-branch 1
        -- Branch 2
        Keep it very simple and logical.`;

        try {
            const res = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${key}`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
            });

            const data = await res.json();
            
            if (data.candidates) {
                const aiText = data.candidates[0].content.parts[0].text;
                
                // рдЖрддрд╛ рдЖрдкрдг рдпрд╛ рдЯреЗрдХреНрд╕реНрдЯрд▓рд╛ рдЗрдореЗрдЬ рдордзреНрдпреЗ рдмрджрд▓рдгрд╛рд▒реНрдпрд╛ рдПрдХрд╛ рдлреНрд░реА рд╕рд░реНрд╡реНрд╣рд┐рд╕рдЪрд╛ рд╡рд╛рдкрд░ рдХрд░реВ (Kroki API)
                // рд╣реЗ Mermaid рд▓рд╛рдпрдмреНрд░рд░реАрд╢рд┐рд╡рд╛рдп рдореЕрдк рдмрдирд╡рддреЗ
                const encodedData = btoa(unescape(encodeURIComponent("mindmap\n" + aiText)));
                img.src = `https://kroki.io/mermaid/svg/${encodedData}`;
                
                img.onload = () => {
                    loading.style.display = "none";
                    img.style.display = "block";
                    status.innerText = "рдореЕрдк рддрдпрд╛рд░ рдЭрд╛рд▓рд╛! тЬЕ";
                };
            } else {
                status.innerText = "Error: Key рддрдкрд╛рд╕рд╛.";
                loading.style.display = "none";
            }
        } catch (e) {
            status.innerText = "рдЗрдВрдЯрд░рдиреЗрдЯ рдХрдиреЗрдХреНрд╢рди рддрдкрд╛рд╕рд╛.";
            loading.style.display = "none";
        }
    }
</script>

</body>
</html>
