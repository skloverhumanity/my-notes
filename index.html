<!DOCTYPE html>
<html lang="mr">
<head>
    <meta charset="UTF-8">
    <title>AI Mindmap - Ultimate Success</title>
    <style>
        body { font-family: sans-serif; background: #f0f2f5; margin: 0; display: flex; flex-direction: column; height: 100vh; }
        .sidebar { width: 300px; background: white; padding: 25px; border-right: 1px solid #ddd; }
        .viewer { flex: 1; display: flex; justify-content: center; align-items: center; background: #ddd; overflow: auto; }
        input, textarea { width: 100%; padding: 10px; margin-bottom: 10px; border-radius: 5px; border: 1px solid #ccc; }
        button { width: 100%; padding: 12px; background: #1a73e8; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; }
        #status { font-size: 13px; color: #d93025; margin-top: 10px; font-weight: bold; }
        img { max-width: 90%; box-shadow: 0 10px 30px rgba(0,0,0,0.1); border-radius: 10px; display: none; }
    </style>
</head>
<body>

<div style="display: flex; flex: 1;">
    <div class="sidebar">
        <h3>üß† AI MindMap</h3>
        <input type="password" id="apiKey" placeholder="‡§§‡•Å‡§Æ‡§ö‡•Ä ‡§®‡§µ‡•Ä‡§® API Key ‡§ü‡§æ‡§ï‡§æ">
        <textarea id="topic" rows="4" placeholder="‡§µ‡§ø‡§∑‡§Ø ‡§≤‡§ø‡§π‡§æ... ‡§â‡§¶‡§æ. GRU and LSTM Backtesting"></textarea>
        <button onclick="makeMap()">AI ‡§Æ‡•Ö‡§™ ‡§§‡§Ø‡§æ‡§∞ ‡§ï‡§∞‡§æ</button>
        <div id="status">Ready</div>
    </div>
    <div class="viewer">
        <div id="loader" style="display:none;">AI ‡§Æ‡§æ‡§π‡§ø‡§§‡•Ä ‡§∂‡•ã‡§ß‡§§ ‡§Ü‡§π‡•á...</div>
        <img id="mapResult" src="">
    </div>
</div>

<script>
async function makeMap() {
    const key = document.getElementById('apiKey').value.trim();
    const topic = document.getElementById('topic').value.trim();
    const status = document.getElementById('status');
    const img = document.getElementById('mapResult');
    const loader = document.getElementById('loader');

    if (!key || !topic) { alert("Key ‡§Ü‡§£‡§ø ‡§µ‡§ø‡§∑‡§Ø ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï!"); return; }

    status.innerText = "‡§™‡•ç‡§∞‡§Ø‡§§‡•ç‡§® ‡§ï‡§∞‡§§ ‡§Ü‡§π‡•á...";
    loader.style.display = "block";
    img.style.display = "none";

    // ‡§Ü‡§™‡§£ ‡§Ü‡§§‡§æ ‡§∏‡§∞‡•ç‡§µ‡§æ‡§§ ‡§ú‡§æ‡§∏‡•ç‡§§ ‡§ö‡§æ‡§≤‡§£‡§æ‡§±‡•ç‡§Ø‡§æ Free ‡§Æ‡•â‡§°‡•á‡§≤‡§ö‡•Ä ‡§≤‡§ø‡§Ç‡§ï ‡§µ‡§æ‡§™‡§∞‡§§ ‡§Ü‡§π‡•ã‡§§
    const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${key}`;

    const prompt = `Create a simple mindmap for "${topic}". Use Mermaid mindmap syntax. Include nodes for GRU and LSTM benefits in backtesting speed. Give only code.`;

    try {
        const response = await fetch(url, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
        });

        const data = await response.json();

        if (data.candidates) {
            let aiCode = data.candidates[0].content.parts[0].text;
            let cleanCode = aiCode.replace(/```mermaid|```/g, "").trim();
            
            // ‡§á‡§Æ‡•á‡§ú‡§Æ‡§ß‡•ç‡§Ø‡•á ‡§∞‡•Ç‡§™‡§æ‡§Ç‡§§‡§∞ ‡§ï‡§∞‡§£‡•ç‡§Ø‡§æ‡§∏‡§æ‡§†‡•Ä Kroki API
            const encoded = btoa(unescape(encodeURIComponent(cleanCode)));
            img.src = `https://kroki.io/mermaid/svg/${encoded}`;
            
            img.onload = () => {
                loader.style.display = "none";
                img.style.display = "block";
                status.style.color = "green";
                status.innerText = "‡§Æ‡•Ö‡§™ ‡§Ø‡§∂‡§∏‡•ç‡§µ‡•Ä‡§∞‡•Ä‡§§‡•ç‡§Ø‡§æ ‡§§‡§Ø‡§æ‡§∞ ‡§ù‡§æ‡§≤‡§æ! ‚úÖ";
            };
        } else {
            // ‡§ú‡§∞ ‡§è‡§∞‡§∞ ‡§Ü‡§≤‡§æ ‡§§‡§∞ ‡§§‡•ã ‡§®‡•á‡§Æ‡§ï‡§æ ‡§ï‡§æ‡§Ø ‡§Ü‡§π‡•á ‡§§‡•á ‡§¶‡§æ‡§ñ‡§µ‡§æ
            status.innerText = "Error: " + (data.error ? data.error.message : "Key ‡§Ö‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§Ü‡§π‡•á.");
            loader.style.display = "none";
        }
    } catch (e) {
        status.innerText = "‡§®‡•á‡§ü‡§µ‡§∞‡•ç‡§ï ‡§™‡•ç‡§∞‡•â‡§¨‡•ç‡§≤‡•á‡§Æ!";
        loader.style.display = "none";
    }
}
</script>

</body>
</html>
