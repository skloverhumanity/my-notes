<!DOCTYPE html>
<html lang="mr">
<head>
    <meta charset="UTF-8">
    <title>AI Backtesting Mindmap</title>
    <style>
        body { font-family: sans-serif; text-align: center; background-color: #f0f4f8; padding: 20px; }
        .container { background: white; padding: 30px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); display: inline-block; max-width: 600px; width: 100%; }
        input { width: 90%; padding: 12px; margin: 10px 0; border: 2px solid #e0e0e0; border-radius: 8px; }
        button { width: 95%; padding: 12px; background-color: #1a73e8; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; }
        #status { margin-top: 20px; font-weight: bold; color: #1a73e8; }
        #mapResult { margin-top: 20px; max-width: 100%; border-radius: 10px; display: none; background: white; }
    </style>
</head>
<body>

<div class="container">
    <h2>üöÄ Backtesting AI Map (v2.0 Flash)</h2>
    <p>GRU ‡§Ü‡§£‡§ø LSTM ‡§Æ‡•â‡§°‡•á‡§≤‡•ç‡§∏‡§ö‡§æ ‡§µ‡•á‡§ó‡§µ‡§æ‡§® ‡§®‡§ï‡§æ‡§∂‡§æ</p>
    <input type="password" id="apiKey" placeholder="‡§§‡•Å‡§Æ‡§ö‡•Ä API Key ‡§ü‡§æ‡§ï‡§æ">
    <button onclick="generateMap()">‡§Æ‡•Ö‡§™ ‡§§‡§Ø‡§æ‡§∞ ‡§ï‡§∞‡§æ ‚ú®</button>
    <div id="status">Ready</div>
</div>

<br>
<img id="mapResult" src="">

<script>
async function generateMap() {
    const key = document.getElementById('apiKey').value.trim();
    const status = document.getElementById('status');
    const img = document.getElementById('mapResult');

    if(!key) { alert("Key ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§Ü‡§π‡•á!"); return; }

    status.innerText = "‡§Æ‡§æ‡§π‡§ø‡§§‡•Ä ‡§Æ‡§ø‡§≥‡§µ‡§§ ‡§Ü‡§π‡•á... (Using Gemini 2.0 Flash)";
    img.style.display = "none";

    // ‡§§‡•Å‡§Æ‡§ö‡•ç‡§Ø‡§æ ‡§≤‡§ø‡§∏‡•ç‡§ü‡§®‡•Å‡§∏‡§æ‡§∞ ‡§Ü‡§™‡§£ ‡§π‡•á ‡§Æ‡•â‡§°‡•á‡§≤ ‡§µ‡§æ‡§™‡§∞‡§§ ‡§Ü‡§π‡•ã‡§§
    const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${key}`;

    const prompt = `Create a detailed Mermaid mindmap for "Stock Market Backtesting using GRU and LSTM". 
    Highlight that GRU is FASTER than LSTM due to fewer gates. 
    Include nodes for: Data Preprocessing, Model Training, and Speed Comparison. 
    Give ONLY the mermaid code starting with "mindmap".`;

    try {
        const response = await fetch(url, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
        });

        const data = await response.json();

        if (data.candidates) {
            let aiText = data.candidates[0].content.parts[0].text;
            let cleanCode = aiText.replace(/```mermaid|```/g, "").trim();
            
            const encoded = btoa(unescape(encodeURIComponent(cleanCode)));
            img.src = `https://kroki.io/mermaid/svg/${encoded}`;
            img.style.display = "block";
            status.style.color = "green";
            status.innerText = "‡§Ø‡§∂‡§∏‡•ç‡§µ‡•Ä! ‡§§‡•Å‡§Æ‡§ö‡§æ ‡§¨‡•Ö‡§ï‡§ü‡•á‡§Ç‡§∏‡•ç‡§ü‡§ø‡§Ç‡§ó ‡§Æ‡•Ö‡§™ ‡§§‡§Ø‡§æ‡§∞ ‡§Ü‡§π‡•á. ‚úÖ";
        } else {
            status.style.color = "red";
            status.innerText = "Error: " + (data.error ? data.error.message : "‡§ï‡§æ‡§π‡•Ä‡§§‡§∞‡•Ä ‡§ö‡•Å‡§ï‡§≤‡•á");
        }
    } catch (e) {
        status.innerText = "Connection Error!";
    }
}
</script>

</body>
</html>
