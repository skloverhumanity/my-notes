<!DOCTYPE html>
<html lang="mr">
<head>
    <meta charset="UTF-8">
    <title>AI MindMap Pro</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; margin: 0; background: #f4f7f6; display: flex; flex-direction: column; height: 100vh; }
        header { background: #1a73e8; color: white; padding: 15px; text-align: center; font-size: 20px; font-weight: bold; }
        .main { display: flex; flex: 1; overflow: hidden; }
        .sidebar { width: 320px; background: white; padding: 25px; border-right: 1px solid #ddd; box-shadow: 2px 0 10px rgba(0,0,0,0.05); }
        input, textarea { width: 100%; padding: 12px; margin-bottom: 15px; border: 1px solid #ccc; border-radius: 8px; box-sizing: border-box; font-size: 14px; }
        button { width: 100%; padding: 12px; background: #1a73e8; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 15px; }
        button:hover { background: #1557b0; }
        #status { font-size: 13px; color: #d93025; margin-top: 15px; font-weight: bold; line-height: 1.4; }
        .viewer { flex: 1; padding: 30px; display: flex; justify-content: center; align-items: flex-start; overflow: auto; background: #e9ecef; }
        #mapImage { max-width: 100%; box-shadow: 0 10px 40px rgba(0,0,0,0.15); border-radius: 12px; display: none; background: white; }
    </style>
</head>
<body>

<header>üß† AI MindMap Pro</header>

<div class="main">
    <div class="sidebar">
        <label style="font-size: 12px; color: #666;">‡§§‡•Å‡§Æ‡§ö‡•Ä API Key ‡§ü‡§æ‡§ï‡§æ:</label>
        <input type="password" id="apiKey" placeholder="Paste Gemini Key Here">
        
        <label style="font-size: 12px; color: #666;">‡§ü‡•ç‡§∞‡•á‡§°‡§ø‡§Ç‡§ó ‡§ï‡§ø‡§Ç‡§µ‡§æ ‡§ï‡•ã‡§£‡§§‡§æ‡§π‡•Ä ‡§µ‡§ø‡§∑‡§Ø ‡§≤‡§ø‡§π‡§æ:</label>
        <textarea id="topic" rows="4" placeholder="‡§â‡§¶‡§æ. Intraday Trading Strategy"></textarea>
        
        <button onclick="generateMap()">AI ‡§Æ‡•Ö‡§™ ‡§§‡§Ø‡§æ‡§∞ ‡§ï‡§∞‡§æ ‚ú®</button>
        
        <div id="status">Ready</div>
    </div>

    <div class="viewer">
        <div id="loading" style="display: none; font-weight: bold; color: #1a73e8;">AI ‡§Ü‡§∞‡§æ‡§ñ‡§°‡§æ ‡§§‡§Ø‡§æ‡§∞ ‡§ï‡§∞‡§§ ‡§Ü‡§π‡•á... ‡§ï‡•É‡§™‡§Ø‡§æ ‡•ß‡•¶-‡•ß‡•´ ‡§∏‡•á‡§ï‡§Ç‡§¶ ‡§•‡§æ‡§Ç‡§¨‡§æ.</div>
        <img id="mapImage" src="" alt="Mindmap Result">
    </div>
</div>

<script>
    async function generateMap() {
        const key = document.getElementById('apiKey').value.trim();
        const topic = document.getElementById('topic').value.trim();
        const status = document.getElementById('status');
        const img = document.getElementById('mapImage');
        const loading = document.getElementById('loading');

        if (!key || !topic) {
            alert("‡§ï‡•É‡§™‡§Ø‡§æ Key ‡§Ü‡§£‡§ø ‡§µ‡§ø‡§∑‡§Ø ‡§¶‡•ã‡§®‡•ç‡§π‡•Ä ‡§ü‡§æ‡§ï‡§æ!");
            return;
        }

        status.style.color = "#1a73e8";
        status.innerText = "‡§§‡§™‡§æ‡§∏‡§§ ‡§Ü‡§π‡•á...";
        loading.style.display = "block";
        img.style.display = "none";

        const prompt = `Create a professional mindmap for "${topic}" in Mermaid.js syntax. Start with "mindmap" and "root((${topic}))". Give only the code.`;

        try {
            const res = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${key}`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
            });

            const data = await res.json();

            if (data.error) {
                status.style.color = "red";
                status.innerHTML = "<b>API Error:</b> " + data.error.message;
                loading.style.display = "none";
            } else if (data.candidates && data.candidates[0].content) {
                const aiText = data.candidates[0].content.parts[0].text;
                const cleanCode = aiText.replace(/```mermaid|```/g, "").trim();
                
                // ‡§¨‡§æ‡§π‡•á‡§∞‡•Ä‡§≤ ‡§á‡§Æ‡•á‡§ú ‡§∏‡§∞‡•ç‡§µ‡•ç‡§π‡§ø‡§∏ ‡§µ‡§æ‡§™‡§∞‡•Ç‡§® ‡§Æ‡•Ö‡§™ ‡§∞‡•á‡§Ç‡§°‡§∞ ‡§ï‡§∞‡§£‡•á (Kroki.io)
                const encodedData = btoa(unescape(encodeURIComponent(cleanCode)));
                img.src = `https://kroki.io/mermaid/svg/${encodedData}`;
                
                img.onload = () => {
                    loading.style.display = "none";
                    img.style.display = "block";
                    status.style.color = "green";
                    status.innerText = "‡§Æ‡•Ö‡§™ ‡§Ø‡§∂‡§∏‡•ç‡§µ‡•Ä‡§∞‡•Ä‡§§‡•ç‡§Ø‡§æ ‡§§‡§Ø‡§æ‡§∞ ‡§ù‡§æ‡§≤‡§æ! ‚úÖ";
                };
            }
        } catch (e) {
            status.style.color = "red";
            status.innerText = "‡§®‡•á‡§ü‡§µ‡§∞‡•ç‡§ï ‡§è‡§∞‡§∞! ‡§á‡§Ç‡§ü‡§∞‡§®‡•á‡§ü ‡§§‡§™‡§æ‡§∏‡§æ.";
            loading.style.display = "none";
        }
    }
</script>

</body>
</html>
